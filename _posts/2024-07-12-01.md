---
layout: post
title: "非线性动力学的识别 (SINDy) 于时间序列数据"
date: 2024-07-12 20:00:00 +0800
categories: create
lang: "zh"
---

<div class="quote-box">
  <p><b>介绍</b></p>
</div>

本项目采用稀疏非线性动力学识别（SINDy）算法，从与流体和气体动力学相关的三种特征的时间序列数据中识别出控制方程。数据来自我之前题为“[使用结构化学习方法增强时间序列数据中的特征预测](/henry.github.io/assets/papers/Backpropagation.pdf)”的项目。分析的三种特征是：输出1处的流体速度、输出1处的气体质量流量和输出2处的气体速度。利用SINDy算法，我们通过构建候选函数库、使用稀疏回归识别最相关的项，并将识别出的方程与观测数据进行验证，重建这些特征的底层数学模型。该项目展示了SINDy在从复杂的时间序列数据中发现简单、可解释模型方面的有效性，增强了我们对流体和气体动力学的理解。

<div class="quote-box">
  <p><b>模型解释：稀疏非线性动力学识别（SINDy）算法</b></p>
</div>

稀疏非线性动力学识别（SINDy）是一种旨在利用候选函数库中的少量项来描述动力系统的简约模型的算法。该方法结合了稀疏回归原理和系统化的非线性函数库，从时间序列数据中识别系统的控制方程。

### 数学公式

考虑一个由常微分方程（ODE）描述的动力系统：

$$\frac{d\mathbf{x}}{dt} = \mathbf{f}(\mathbf{x})$$

其中，$$\mathbf{x} \in \mathbb{R}^n$$ 是系统的状态向量，$$\mathbf{f}$$ 代表非线性动力学。

SINDy的目标是通过预定义库中的候选函数的稀疏线性组合来近似函数$$\mathbf{f}$$。这个过程包括以下步骤：

1. **数据收集**：
   收集状态变量$$ \mathbf{x}(t) $$的时间序列数据。令$$ \mathbf{X} $$为包含这些测量值的矩阵，其中每列对应一个不同的状态变量，每行对应一个不同的时间点。

2. **库构建**：
   构建一个候选函数库$$ \mathbf{\Theta}(\mathbf{X}) $$。该库包括状态变量的各种非线性函数，如多项式、三角函数和指数函数。从数学上讲，该库可以表示为：

   $$ \mathbf{\Theta}(\mathbf{X}) = [\mathbf{1}, \mathbf{X}, \mathbf{X}^2, \sin(\mathbf{X}), \cos(\mathbf{X}), \exp(\mathbf{X}), \mathbf{X} \exp(\mathbf{X}), \ldots], $$

   其中$$ \mathbf{\Theta} $$的每一列代表一个不同的候选函数。

3. **稀疏回归**：
   对于每个状态变量$$ x_i $$，将时间导数$$ \frac{dx_i}{dt} $$表示为候选函数$$ \mathbf{\Theta}(\mathbf{X}) $$的线性组合：

   $$ \frac{d\mathbf{X}}{dt} = \mathbf{\Theta}(\mathbf{X}) \mathbf{\Xi}, $$

   其中$$ \mathbf{\Xi} $$是系数矩阵，每列对应一个不同的状态变量。关键思想是在$$ \mathbf{\Xi} $$中施加稀疏性，即大多数系数应为零。可以使用稀疏回归技术如最小绝对收缩和选择算子（LASSO）来实现：

   $$ \mathbf{\Xi} = \underset{\mathbf{\Xi}}{\operatorname{argmin}} \left\| \frac{d\mathbf{X}}{dt} - \mathbf{\Theta}(\mathbf{X}) \mathbf{\Xi} \right\|_2^2 + \lambda \left\| \mathbf{\Xi} \right\|_1, $$

   其中$$ \lambda $$是控制解稀疏性的正则化参数。

4. **模型识别**：
   系数矩阵$$ \mathbf{\Xi} $$中的非零项对应于库$$ \mathbf{\Theta}(\mathbf{X}) $$中最能描述系统动力学的项。识别出的模型可以写成：

   $$ \frac{dx_i}{dt} = \sum_{j} \xi_{ij} \theta_j(\mathbf{x}), $$

   其中$$ \xi_{ij} $$是非零系数，$$ \theta_j(\mathbf{x}) $$是对应的候选函数。

<div class="image-container">
  <img src="{{ '/assets/blog_images/0711_1.JPG' | relative_url }}" alt="Image 1">
   <br>
   <div class="caption">应用于洛伦兹等式的SINDy算法概略图</div>
</div>

总之，SINDy提供了一个强大的框架，可以从数据中识别控制方程，通过稀疏和可解释的模型提供对复杂系统动力学的洞察。你可以在[这里](https://www.pnas.org/doi/pdf/10.1073/pnas.1517384113)阅读原始的SINDy论文。

<div class="quote-box">
  <p><b>数据处理</b></p>
</div>

### 初步处理

本项目分析的数据源自之前的机器学习项目，题为[“使用结构化学习方法增强时间序列数据中的特征预测”](/henry.github.io/assets/papers/Backpropagation.pdf)。该项目旨在使用不同模型的组合建立所选特征$$ X = (X_1, X_2) $$与目标特征$$ Y = (Y_1, Y_2, Y_3) $$之间的统计关系。学习架构包括三个主要阶段：初始预测、残差训练和模型优化。通过这种参数聚焦的方法，我们获得了目标特征的预测$$ Y_{\text{final}} $$，其相对均方误差（MSE）为0.0005。然而，这些数值预测缺乏解释和数学推理，特别是在最后阶段，我们使用了多层感知器（MLP），这种模型常被批评为“黑箱”。

因此，在本项目中，我希望使用SINDy为这些结果构建控制方程的近似。虽然近似的控制方程可能无法提供与数值模型一样准确的结果，但我希望它们能为结果提供更多的数学推理，并增强我们对流体和气体动力学的理解。

当前SINDy项目分析的三种特征是：

1. **输出1处的流体速度**：该特征表示流体在第一个输出点的移动速度。理解系统内流体流动的动态和行为至关重要。

2. **输出1处的气体质量流量**：该特征测量单位时间内通过第一个输出点的气体质量。评估系统内气体传输的效率和性能至关重要。

3. **输出2处的气体速度**：该特征表示第二个输出点的气体流动速度。了解气体动力学行为对优化和控制气体相关过程至关重要。

这些特征在一系列时间步长中记录，生成了三列时间序列数据。

<div class="image-container">
  <img src="{{ '/assets/blog_images/0711_2.JPG' | relative_url }}" alt="Image 2">
   <br>
   <div class="caption">三个特征的时间序列图</div>
</div>

### 候选选择

为了识别这三种特征的控制方程，我们构建了一个候选函数库。所选择的候选函数旨在捕捉系统内可能的多种动态。该库包括：

1. **常数项**：表示所有时间步长中的常数值，捕捉数据中的任何基线水平。该项有助于解释数据中的任何稳态行为或偏移。

2. **线性项 $$ t $$**：捕捉数据随时间的任何线性趋势。该项对于识别值的任何稳定增加或减少非常重要，这可能对应于系统中的一致加速或减速。

3. **二次项 $$ t^2 $$**：解释数据中的任何二次或抛物线趋势。该项对于建模随时间变化的加速或减速非常有用，通常出现在经历非线性增长或衰减的系统中。

4. **指数项 $$ \exp(-t) $$**：建模指数衰减，这是许多物理和化学过程中常见的，例如放射性衰变、冷却或机械系统中的阻尼。随着$$ t $$增加，该函数的形状迅速减小到零，非常适合捕捉随时间减少的过程。

5. **正弦项 $$ \sin(t) $$**：捕捉数据中的周期性振荡或循环，通常出现在具有谐波运动的系统中，如波动、振动或季节性变化。正弦函数对于识别规律间隔重复的循环行为非常有价值。

6. **余弦项 $$ \cos(t) $$**：补充正弦项，捕捉相位移的周期性行为。正弦项从零开始，而余弦项从一开始，使得捕捉不同相位的振荡行为成为可能。

7. **交互项 $$ t \cdot \exp(-t) $$**：表示线性和指数动力学的组合，用于建模系统中更复杂的交互。这一项从零开始，增加到峰值，然后衰减，适合建模随时间最初增长然后衰减的过程。

这些候选函数被选择用来提供一个全面且相对简单的基础，以近似控制方程。当然，您可以选择尽可能多的复杂项来获得更接近的近似；然而，在可解释性和过拟合之间的选择是微妙的。

<div class="quote-box">
  <p><b>网络设置和训练</b></p>
</div>

1. **库构建**：
   为每个特征构建候选函数库。该库包括常数、线性、二次、指数、正弦、余弦和交互项。这些候选函数被选择用来捕捉系统内可能的多种动态。

2. **数据分割**：
   每个特征的数据分为三个区间：
   - 区间1：$$ t \in [0, 10) $$
   - 区间2：$$ t \in [10, 600) $$
   - 区间3：$$ t \in [600, 2000] $$

   将数据分割成这些区间可以捕捉不同时间段内可能发生的不同动态行为。每个区间单独处理，以确保识别出的控制方程特定于该区间内的动态，从而更准确和详细地理解系统随时间的行为。

3. **稀疏回归**：
   使用LassoCV算法（一种L1正则化线性回归）来拟合数据。这个过程包括：
   - 对候选函数进行缩放以标准化数据。
   - 执行交叉验证以确定最优正则化参数($$\lambda$$)。
   - 识别控制方程中最显著项的系数，确保生成的模型既稀疏又可解释。

4. **方程构建**：
   对于每个区间和每个特征，将识别出的系数和项结合形成控制方程。这些分段方程提供了该区间内动力学的详细数学表示，通过揭示驱动观测行为的底层过程，增强了我们对流体和气体动力学的理解。

<div class="quote-box">
  <p><b>实验结果</b></p>
</div>

实验结果显示在下图中：

<div class="image-container">
  <img src="{{ '/assets/blog_images/0711_3.JPG' | relative_url }}" alt="Image 3">
   <br>
   <div class="caption">识别出的控制方程及其对应的图与实际结果对比</div>
</div>

实验结果将每个特征的实际时间序列数据与使用SINDy算法得出的控制方程进行比较。分析的三个特征是：<i>输出1处的流体速度</i>、<i>输出1处的气体质量流量</i>和<i>输出2处的气体速度</i>。

总体而言，识别出的方程捕捉到了实际数据的总体趋势和动态行为。SINDy算法通过选择控制方程中的有限数量的显著项，成功地平衡了简单性（可解释性）和准确性（避免过拟合）。这种平衡确保了模型在提供对底层动力学的良好近似的同时仍然可解释。

在图中，识别出的分段方程与实际数据一起呈现。这些方程提供了系统在每个区间内行为的详细数学表示。尽管在某些区间，识别出的数据与实际数据之间存在一些偏差，但总体拟合度很强，展示了SINDy方法在捕捉流体和气体行为的基本动力学方面的有效性。

<div class="quote-box">
  <p><b>结论</b></p>
</div> 

在本项目中，我们应用稀疏非线性动力学识别（SINDy）算法识别了来自之前机器学习项目的时间序列数据的控制方程。本研究中出现了几个关键点和反思：

1. **候选选择是关键**：
   选择适当的候选函数来构建库是SINDy最关键的部分。库直接影响识别方程的有效性和准确性。一个选择良好的库可以让模型在保持可解释性的同时捕捉系统的基本动态。

2. **系统的先验知识**：
   SINDy的成功在很大程度上依赖于对系统的先验知识，以选择正确的候选函数。这在现实世界中可能面临挑战，因为数据的背景信息可能有限或不可用。在这种情况下，SINDy的有效性仍然是一个未解的问题，强调了对算法进一步研究和潜在改进的需求。

3. **简单性与准确性之间的平衡**：
   在SINDy中，达到简单性与准确性之间的平衡是一个微妙且关键的步骤。虽然添加更复杂的候选函数可以提高近似精度，但可能导致过拟合，并产生难以物理解释的项。例如，像$$\sin(\exp(t^{\tan(\exp(t^4))}))$$这样的项可能改善拟合但缺乏物理意义和可解释性。目标是找到一个中间地带，使模型既准确又可解释，从而提供对系统动力学的有意义见解。

4. **代码仓库**：本项目的完整代码可在[GitHub](https://github.com/henryli121/SINDy-govern-equation-.git)上找到。

5. **原始报告**：以上报告是基于我的原始英文研究报告并由ChatGPT-4o提供翻译。请通过[此处](https://henryli121.github.io/henry.github.io/research/2024/07/11/01/)查看更准确的措辞和解释。